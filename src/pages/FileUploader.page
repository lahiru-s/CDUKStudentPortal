<apex:page standardController="Document" extensions="FileUploaderController" standardStylesheets="false" showHeader="false">
    <apex:includeScript value="{!$Resource.PaceJS}"></apex:includeScript>
    <apex:stylesheet value="{!URLFOR($Resource.LightningDesignSystem, 'styles/salesforce-lightning-design-system.css')}" />
    
    <style>
        html,body {
            background-color: transparent !important;
            padding: 5px 0;
        }
        
        .dotted-border {
            padding: 11px 3px 13px 3px;
            border-radius: 3px;
        }
        
        .inputFile {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            height: 80px;
        }
        
        .inputFile-wrapper {
            width: 250px;
            height: 35px;
            border: 1px dashed #c9c7c5;
            cursor: pointer;
        }
        
        .pace {
          -webkit-pointer-events: none;
          pointer-events: none;
          -webkit-user-select: none;
          -moz-user-select: none;
          user-select: none;
        }
        
        .pace-inactive {
          display: none;
        }
        
        .pace .pace-progress {
          background: #29d;
          position: fixed;
          z-index: 2000;
          top: 0;
          right: 100%;
          width: 100%;
          height: 2px;
        }
        
        .pace .pace-progress-inner {
          display: block;
          position: absolute;
          right: 0px;
          width: 100px;
          height: 100%;
          box-shadow: 0 0 10px #29d, 0 0 5px #29d;
          opacity: 1.0;
          -webkit-transform: rotate(3deg) translate(0px, -4px);
          -moz-transform: rotate(3deg) translate(0px, -4px);
          -ms-transform: rotate(3deg) translate(0px, -4px);
          -o-transform: rotate(3deg) translate(0px, -4px);
          transform: rotate(3deg) translate(0px, -4px);
        }
        
        .pace .pace-activity {
          display: block;
          position: fixed;
          z-index: 2000;
          top: 15px;
          right: 15px;
          width: 14px;
          height: 14px;
          border: solid 2px transparent;
          border-top-color: #29d;
          border-left-color: #29d;
          border-radius: 10px;
          -webkit-animation: pace-spinner 400ms linear infinite;
          -moz-animation: pace-spinner 400ms linear infinite;
          -ms-animation: pace-spinner 400ms linear infinite;
          -o-animation: pace-spinner 400ms linear infinite;
          animation: pace-spinner 400ms linear infinite;
        }
        
        @-webkit-keyframes pace-spinner {
          0% { -webkit-transform: rotate(0deg); transform: rotate(0deg); }
          100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }
        }
        @-moz-keyframes pace-spinner {
          0% { -moz-transform: rotate(0deg); transform: rotate(0deg); }
          100% { -moz-transform: rotate(360deg); transform: rotate(360deg); }
        }
        @-o-keyframes pace-spinner {
          0% { -o-transform: rotate(0deg); transform: rotate(0deg); }
          100% { -o-transform: rotate(360deg); transform: rotate(360deg); }
        }
        @-ms-keyframes pace-spinner {
          0% { -ms-transform: rotate(0deg); transform: rotate(0deg); }
          100% { -ms-transform: rotate(360deg); transform: rotate(360deg); }
        }
        @keyframes pace-spinner {
          0% { transform: rotate(0deg); transform: rotate(0deg); }
          100% { transform: rotate(360deg); transform: rotate(360deg); }
        }
    </style>
    
    <apex:form >
        <span class="dotted-border">
            <div class="slds-button slds-button_neutral slds-theme_shade inputFile-wrapper">
                <apex:inputFile value="{!Document.Body}" filename="{!Document.Name}" styleClass="inputFile" onchange="captureFileName()"/>
                <span id="file-name" class="slds-m-top_x-small">Choose File...</span>
            </div>
        </span>
        
        <apex:commandButton id="btnUpload" value="Upload" action="{!quicksave}" styleClass="slds-button slds-button_neutral slds-float_right slds-m-right_small slds-theme_shade slds-hide"/>
        
        <apex:outputPanel rendered="{!NOT(ISBLANK(Document.Id))}" layout="none">
            <span class="slds-m-left_xx-small"><small>Uploaded File</small>: <strong>{!Document.Name}</strong></span>
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!NOT(ISBLANK(Document.Id))}" layout="none">
            <script>
                window.parent.uploadedFiles["{!$CurrentPage.parameters.var}"] = "{!Document.Id}";
            </script>
        </apex:outputPanel>
    </apex:form>
    
    <script>
        var captureFileName = function() {
            document.querySelector( "[id='file-name']" ).innerHTML = document.querySelector("[type=file]").files[0].name;
            
            document.querySelector( "[id*=btnUpload]" ).click();
        };
    </script>
</apex:page>